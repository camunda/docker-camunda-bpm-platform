language: generic

sudo: required

services:
    - docker

env:
    - DISTRO=tomcat VERSION=7.9.0 SNAPSHOT=true
    - DISTRO=wildfly10 VERSION=7.9.0 SNAPSHOT=true
    - DISTRO=wildfly11 VERSION=7.9.0 SNAPSHOT=true

before_script:
    - docker build -t camunda/camunda-bpm-platform:${DISTRO} --build-arg DISTRO=${DISTRO} --build-arg VERSION=${VERSION} --build-arg SNAPSHOT=${SNAPSHOT} .

script:
    - ./test.sh
    - docker login -u "${DOCKER_HUB_USERNAME}" -p "${DOCKER_HUB_PASSWORD}"
    - ./release.sh
