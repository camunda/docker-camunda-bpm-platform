language: generic

sudo: required

services:
    - docker

env:
    - DISTRO=tomcat VERSION=7.9.0 SNAPSHOT=true
    - DISTRO=wildfly10 VERSION=7.9.0 SNAPSHOT=true
    - DISTRO=wildfly11 VERSION=7.9.0 SNAPSHOT=true

script:
    - docker build -t camunda/camunda-bpm-platform:${DISTRO} --build-arg DISTRO=${DISTRO} --build-arg VERSION=${VERSION} --build-arg SNAPSHOT=${SNAPSHOT} .
    - cd test/h2
    - ../test-${DISTRO}.sh
    - cd ../postgresql
    - ../test-${DISTRO}.sh
    - cd ../mysql
    - ../test-${DISTRO}.sh
