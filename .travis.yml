language: generic

sudo: required

services:
    - docker

env:
    - DISTRO=tomcat VERSION=7.6.0
    - DISTRO=tomcat VERSION=7.6.0 EE=true
    - DISTRO=tomcat VERSION=7.7.0
    - DISTRO=tomcat VERSION=7.7.0 EE=true
    - DISTRO=tomcat VERSION=7.8.0
    - DISTRO=tomcat VERSION=7.8.0 EE=true
    - DISTRO=tomcat VERSION=7.9.0-alpha4
    - DISTRO=tomcat VERSION=7.9.0-alpha4 EE=true
    - DISTRO=tomcat VERSION=7.9.0 SNAPSHOT=true
    - DISTRO=tomcat VERSION=7.9.0 SNAPSHOT=true EE=true
    - DISTRO=tomcat VERSION=7.6.0
    - DISTRO=tomcat VERSION=7.6.0 EE=true
    - DISTRO=tomcat VERSION=7.7.0
    - DISTRO=tomcat VERSION=7.7.0 EE=true
    - DISTRO=tomcat VERSION=7.8.0
    - DISTRO=tomcat VERSION=7.8.0 EE=true
    - DISTRO=tomcat VERSION=7.8.7 SNAPSHOT=true
    - DISTRO=tomcat VERSION=7.8.7 SNAPSHOT=true EE=true
    - DISTRO=tomcat VERSION=7.9.0-alpha4
    - DISTRO=tomcat VERSION=7.9.0-alpha4 EE=true
    - DISTRO=tomcat VERSION=7.9.0 SNAPSHOT=true
    - DISTRO=tomcat VERSION=7.9.0 SNAPSHOT=true EE=true
    - DISTRO=wildfly10 VERSION=7.6.0
    - DISTRO=wildfly10 VERSION=7.6.0 EE=true
    - DISTRO=wildfly10 VERSION=7.7.0
    - DISTRO=wildfly10 VERSION=7.7.0 EE=true
    - DISTRO=wildfly10 VERSION=7.8.0
    - DISTRO=wildfly10 VERSION=7.8.0 EE=true
    - DISTRO=wildfly10 VERSION=7.9.0-alpha4
    - DISTRO=wildfly10 VERSION=7.9.0-alpha4 EE=true
    - DISTRO=wildfly10 VERSION=7.9.0 SNAPSHOT=true
    - DISTRO=wildfly10 VERSION=7.9.0 SNAPSHOT=true EE=true
    - DISTRO=wildfly10 VERSION=7.6.0
    - DISTRO=wildfly10 VERSION=7.6.0 EE=true
    - DISTRO=wildfly10 VERSION=7.7.0
    - DISTRO=wildfly10 VERSION=7.7.0 EE=true
    - DISTRO=wildfly10 VERSION=7.8.0
    - DISTRO=wildfly10 VERSION=7.8.0 EE=true
    - DISTRO=wildfly10 VERSION=7.8.7 SNAPSHOT=true
    - DISTRO=wildfly10 VERSION=7.8.7 SNAPSHOT=true EE=true
    - DISTRO=wildfly10 VERSION=7.9.0-alpha4
    - DISTRO=wildfly10 VERSION=7.9.0-alpha4 EE=true
    - DISTRO=wildfly10 VERSION=7.9.0 SNAPSHOT=true
    - DISTRO=wildfly10 VERSION=7.9.0 SNAPSHOT=true EE=true

script:
    - docker build -t camunda/camunda-bpm-platform:${DISTRO} --build-arg DISTRO=${DISTRO} --build-arg VERSION=${VERSION} --build-arg SNAPSHOT=${SNAPSHOT} --build-arg EE=${EE} --build-arg USER=${NEXUS_USER} --build-arg PASSWORD=${NEXUS_PASS} .
    - cd test/h2
    - ../test-${DISTRO}.sh
    - cd ../postgresql
    - ../test-${DISTRO}.sh
    - cd ../mysql
    - ../test-${DISTRO}.sh
